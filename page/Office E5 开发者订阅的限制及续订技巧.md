# Office E5 开发者订阅的限制及续订技巧

许多人都申请了 Office E5 试用订阅，它特别适合初创和小型企业，最多支持 25 个用户，每个用户都可享受 Office 365 全家桶的完整功能，堪称微软的一大福利。

理论上，只要活跃使用该订阅，它就会自动续期。然而，近期几次的清理表明，虚假的活跃使用（例如通过脚本自动续期）并不被推荐。自 2020 年申请以来，我个人一直正常使用，主要开发内容包括 Graph API 登录和 Onedrive 自动备份。以下是一些经验和知识的分享。

## 使用限制

以下信息摘自微软官方文档，详情请参考原文。

### Graph API 的全局限制

| 请求类型 | 所有租户中的每个应用 |
|---|---|
| 任何 | 每 10 秒 130,000 个请求 |

### Onedrive 的节流限制

Onedrive 的请求方式基于 SharePoint，需遵循 SharePoint 的节流限制。E5 订阅仅支持 25 个许可证，这意味着每分钟最多只能发出 1,200 个资源单位的请求。

| 许可证计数 | 0 – 1k | 1k – 5k | 5k - 15k | 15k - 50k | 50k+ |
|---|---|---|---|---|---|
| 应用 1 分钟 | 1,200 | 2,400 | 3,600 | 4,800 | 6,000 |
| 每日应用 | 1,200,000 | 2,400,000 | 3,600,000 | 4,800,000 | 6,000,000 |

### 资源单位的计算方式

不同请求类型会消耗不同数量的资源单位，具体如下：

| 每个请求的资源单位数 | 运营 |
|---|---|
| 1 | 单个项目查询，例如获取项；带令牌的增量 |
| 2 | 包含令牌的增量除外，多项查询（如列表子项）；创建、更新、删除和上传 |
| 5 | 所有权限资源操作，包括 $expand=权限 |

根据文档，使用 [Microsoft Graph](https://bbtdd.com/WildCard) 可以提高应用程序的性能并减少限制。因此，使用 Graph API 进行 Onedrive 的下载调用，可能会受到更宽松的限制。

## 保持订阅的关键技巧

### 避免使用托管自动续期服务

为确保正常续期，建议不要依赖托管自动续期服务。

### 活跃使用的有效方法

以下是一些有效保持订阅活跃的方法：

- 充分使用并挂载 Onedrive 服务。
- 在电脑上登录 Office 365 E5 账户。
- 注册一个 Graph 应用程序，例如实现微软 OAuth 登录，每次用户登录都是一次有效的 API 调用。

个人经验中，我注册了一个 Graph 应用程序，为网站提供了微软登录方式，同时还使用了 Alist 挂载 Onedrive。

## 成功续期的建议

希望你能顺利保持订阅，并利用它开发一些实用的功能。

![Onedrive 挂载示例](https://bbtdd.com/img/21950441.webp)

👉 [WildCard | 一分钟注册，轻松订阅海外线上服务](https://bbtdd.com/WildCard)

## 参考文献

本文数据均来源于微软官方文档。